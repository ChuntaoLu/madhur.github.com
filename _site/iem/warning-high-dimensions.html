<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Warning! High Dimensions Ahead &larr; Inductio Ex Machina</title>
   <meta name="author" content="Madhur Ahuja" />

     <link rel="start" href="/" />

	
	
	
  	<link rel="alternate" type="application/atom+xml" href="atom.xml" title="RSS feed" />
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/files/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/files/css/screen.css" type="text/css" />

</head>
<body id="">
<div id="site">

  
<div id="header">
	<h1>
	<a href="/iem/" title="A machine learning blog">Inductio ex Machina</a>
	<span class="byline">&larr; <a href="/">Mark Reid</a></span>
</h1>
<ul class="nav">
  <li><a class="home" href="/iem/">Home</a></li>
  <li><a class="info" href="/iem/info.html">Info</a></li>
  <li><a class="past" href="/iem/past.html">Past</a></li>
  <li><a class="kith" href="/iem/kith.html">Kith</a></li>
</ul>

</div>

<div id="page">
	
  <h1 class="emphnext">Warning! High Dimensions Ahead</h1>

<p>Machine learning is often framed as finding surfaces (usually <a href='http://hunch.net/?p=524'>planes</a>) that separate or fit points in some high dimensional space. Two and three dimensional diagrams are often used as an aid to intuition when thinking about these higher dimensional spaces. The following result (related to me by <a href='http://www.hutter1.net/'>Marcus Hutter</a>) shows that our low dimensional intuition can easily lead us astray.</p>

<p>Consider the diagram in Figure 1. The larger grey spheres have radius 1 and are each touching exactly two other grey spheres. The blue circle is then placed so that it touches all four grey circles.</p>

<p>Pythagoras tells us that <span class='maruku-inline'><img class='maruku-png' src='/images/latex/014d551b960aa015f50cec77fe3123f5.png' alt='$1^2 + 1^2 = (1+r)^2$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> and so <span class='maruku-inline'><img class='maruku-png' src='/images/latex/0a76a7dc98b4c952dd067f328b09af62.png' alt='$r = \sqrt{2} - 1 \approx 0.41$' style='vertical-align: -0.444444444444444ex;height: 2.33333333333333ex;' /></span>. Clearly then, the blue circle lies entirely within the square of width 4 containing all the grey spheres.</p>

<dl class='figure'>
<dt><img src='/images/figures/high-dim-2d.png' alt='2-dimensional packing' /></dt>

<dd><strong>Figure 1.</strong> The blue circle in the middle touches each of the four identical grey circles.</dd>
</dl>

<p>We can move to three dimensions and set up an analogue of the two dimensional situation by arranging eight spheres of radius 1 so they are touching exactly three other grey spheres.</p>

<p>As in the case with circles, we can place a blue sphere inside the eight grey spheres so that it touches all of them. In this case, the radius of the blue sphere can be found by solving <span class='maruku-inline'><img class='maruku-png' src='/images/latex/dc428cf1bcb85239e2aab231d197d7ed.png' alt='$1^2 + 1^2 + 1^2 = (1+r)^2$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> and so <span class='maruku-inline'><img class='maruku-png' src='/images/latex/f9645e341f06b1e3369f9a8a2ece7f08.png' alt='$r = \sqrt{3} -1 \approx 0.73$' style='vertical-align: -0.444444444444444ex;height: 2.33333333333333ex;' /></span>, thus it is still inside the cube of width 4 that holds all eight grey spheres.</p>

<dl class='figure'>
<dt><img src='/images/figures/high-dim-3d.png' alt='3-dimensional packing' /></dt>

<dd><strong>Figure 2.</strong> The blue sphere touches each of the eight identical grey spheres.</dd>
</dl>

<p>It&#8217;s not too hard to convince yourself that we can carry on this construction through to higher dimensions.</p>

<p>In four dimensional space we would arrange 16 grey hyperspheres of radius 1 so that each is touching exactly four others. In this case, <span class='maruku-inline'><img class='maruku-png' src='/images/latex/8a8a5cad9ea681f4f73b7a0778359473.png' alt='$r = \sqrt{4} - 1 = 1$' style='vertical-align: -0.444444444444444ex;height: 2.33333333333333ex;' /></span> and the blue hypersphere is the same size as the grey ones. Going up again to five dimensional space, we would have 32 hyperspheres, each touching five others. Following the pattern, in this case <span class='maruku-inline'><img class='maruku-png' src='/images/latex/1e1f647ac12e80f76e4fb827264b3144.png' alt='$r = \sqrt{5} - 1 \approx 1.23$' style='vertical-align: -0.444444444444444ex;height: 2.33333333333333ex;' /></span>. and the blue sphere is larger than the grey spheres in this case but still within the hypercube of width 4 that contains all 32 grey hyperspheres.</p>

<p>The pattern should now be apparent. In n-dimensional space there will be <span class='maruku-inline'><img class='maruku-png' src='/images/latex/77b1e846a413afb6348073092f11cbcd.png' alt='$2^n$' style='vertical-align: -0.0ex;height: 1.55555555555556ex;' /></span> grey hyperspheres of radius 1 that touch <span class='maruku-inline'><img class='maruku-png' src='/images/latex/fba01e94f33c55af5e1ca9ef426e732b.png' alt='$n$' style='vertical-align: -0.0ex;height: 1.0ex;' /></span> other hyperspheres and the radius of the blue sphere that touches all of them will be</p>
<div class='maruku-equation'><img class='maruku-png' src='/images/latex/94c8f35e612e558f07d2b6195c5b1ccd.png' alt='$r = \sqrt{n} - 1.$' style='height: 2.33333333333333ex;' /><span class='maruku-eq-tex'><code style='display: none'>r = \sqrt{n} - 1.</code></span></div>
<p>At this point Dorothy turns to her canine companion and says, &#8220;We are not in three dimensional Kansas anymore, Toto.&#8221;</p>

<p>The blue sphere that sits in the centre of all the grey ones will have a radius that increases without bound. A particularly curious thing happens when we construct the 9-dimensional case. The radius of the blue hypersphere is <span class='maruku-inline'><img class='maruku-png' src='/images/latex/1484764cd43ef52d69b3c86cf17d2da9.png' alt='$\sqrt{9} - 1 = 2$' style='vertical-align: -0.444444444444444ex;height: 2.33333333333333ex;' /></span> and so touches the faces of the hypercube that contains all the grey hyperspheres.</p>

<p>Stranger still, once we are in 10 dimensional space or higher, parts of the blue hypersphere will <em>hang outside</em> the box holding all the grey ones.</p>

<p>Thinking about the relative volume of the containing box and the grey spheres gives us some insight into what is happening. In <span class='maruku-inline'><img class='maruku-png' src='/images/latex/fba01e94f33c55af5e1ca9ef426e732b.png' alt='$n$' style='vertical-align: -0.0ex;height: 1.0ex;' /></span> dimensions the volume of the containing box is <span class='maruku-inline'><img class='maruku-png' src='/images/latex/0bbe900d40044b1389243c5b45bb00a6.png' alt='$4^n$' style='vertical-align: -0.111111111111111ex;height: 1.66666666666667ex;' /></span> while the <a href='http://en.wikipedia.org/wiki/N-sphere#n-ball'>volume of a <span class='maruku-inline'><img class='maruku-png' src='/images/latex/fba01e94f33c55af5e1ca9ef426e732b.png' alt='$n$' style='vertical-align: -0.0ex;height: 1.0ex;' /></span>-ball with radius 1</a> is</p>
<div class='maruku-equation'><img class='maruku-png' src='/images/latex/b36578efbb1ef37899fc94a5a27d8ef0.png' alt='$\displaystyle
	\frac{\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2}+1)} 
	= \begin{cases}
		\displaystyle \pi^k / k! ,&amp; n=2k \\
		\displaystyle 2^{2k+1}k!\pi^k / (2k+1)! ,&amp; n=2k+1
	\end{cases}$' style='height: 6.66666666666667ex;' /><span class='maruku-eq-tex'><code style='display: none'>\displaystyle
	\frac{\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2}+1)} 
	= \begin{cases}
		\displaystyle \pi^k / k! ,&amp; n=2k \\
		\displaystyle 2^{2k+1}k!\pi^k / (2k+1)! ,&amp; n=2k+1
	\end{cases}</code></span></div>
<p>where <span class='maruku-inline'><img class='maruku-png' src='/images/latex/41dea8a48ca04aa928fb0cfb0ad661d0.png' alt='$\Gamma$' style='vertical-align: -0.0ex;height: 1.55555555555556ex;' /></span> is the <a href='http://en.wikipedia.org/wiki/Gamma_function'>generalised factorial function</a>.</p>

<p>For simplicity let us only consider the even dimensional cases where <span class='maruku-inline'><img class='maruku-png' src='/images/latex/95e129ccdcc8f2a6c4fb76d867d97a90.png' alt='$n=2k$' style='vertical-align: -0.0ex;height: 1.55555555555556ex;' /></span>. Here, the total volume of the <span class='maruku-inline'><img class='maruku-png' src='/images/latex/77b1e846a413afb6348073092f11cbcd.png' alt='$2^n$' style='vertical-align: -0.0ex;height: 1.55555555555556ex;' /></span> grey hyperspheres is <span class='maruku-inline'><img class='maruku-png' src='/images/latex/00d025831738f19608a88db1adc16eac.png' alt='$2^{2k} \pi^k / k!$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> and so the proportion of the box occupied by the grey hyperspheres is</p>
<div class='maruku-equation'><img class='maruku-png' src='/images/latex/9de7222c299e903bdb6968f532f0a4ce.png' alt='$\displaystyle
	\frac{2^{2k}\pi^k}{4^k k!} = \left(\frac{\pi}{4}\right)^k / k!$' style='height: 5.0ex;' /><span class='maruku-eq-tex'><code style='display: none'>\displaystyle
	\frac{2^{2k}\pi^k}{4^k k!} = \left(\frac{\pi}{4}\right)^k / k!</code></span></div>
<p>Since factorials are faster growing than exponentials the total proportion of volume occupied by the grey sphere in the box goes to zero as the dimension increases. In effect, the grey hyperspheres are &#8220;disappearing&#8221; relative to the containing box, leaving more room for the blue sphere to fill.</p>

<p>The moral of this story should be familiar to anyone in machine learning: generalising from a handful of examples is a bad idea. What seems obvious in two and three dimensional space does not hold in 10 dimensions or higher.</p>

  <address class="signature">
    <a class="author" href="http://madhur.github.com">Madhur Ahuja</a> 
    <span class="date">25 January 2009</span>
    <span class="location">Canberra, Australia</span>
  </address>
</div><!-- End Page -->


<!-- Discus Comments -->
<div id="disqus_thread"></div>

<!-- Enable Disqus comments -->
<script type="text/javascript">
	var disqus_iframe_css = "http://mark.reid.name/css/screen.css";
	var disqus_title = "Warning! High Dimensions Ahead";
	var disqus_message = "A very counter-intuitive result that highlights the danger of reasoning about higher dimensional space by analogy with lower dimensional ones.";
</script>
<script type="text/javascript" src="http://disqus.com/forums/markreid/embed.js"></script>

<noscript>
		<a href="http://markreid.disqus.com/?url=ref">View the discussion thread.</a>
</noscript>

  
  <div id="footer">
	<address>
		<span class="copyright">
			Content &amp; Design by 
			<a href="/info/site.html">Madhur Ahuja</a>
			<br/>
			(Some rights reserved)			
		</span>
		<span class="engine">
			Powered by 
			<a href="http://github.com/mreid/jekyll/" title="A static, minimalist CMS">Jekyll</a>
		</span>
	</address>
  </div>
</div>
<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
</body>
</html>
