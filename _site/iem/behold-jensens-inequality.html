<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Behold! Jensen's Inequality &larr; Inductio Ex Machina</title>
   <meta name="author" content="Madhur Ahuja" />

     <link rel="start" href="/" />

	
	
	
  	<link rel="alternate" type="application/atom+xml" href="atom.xml" title="RSS feed" />
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/files/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/files/css/screen.css" type="text/css" />

</head>
<body id="">
<div id="site">

  
<div id="header">
	<h1>
	<a href="/iem/" title="A machine learning blog">Inductio ex Machina</a>
	<span class="byline">&larr; <a href="/">Mark Reid</a></span>
</h1>
<ul class="nav">
  <li><a class="home" href="/iem/">Home</a></li>
  <li><a class="info" href="/iem/info.html">Info</a></li>
  <li><a class="past" href="/iem/past.html">Past</a></li>
  <li><a class="kith" href="/iem/kith.html">Kith</a></li>
</ul>

</div>

<div id="page">
	
  <h1 class="emphnext">Behold! Jensen's Inequality</h1>

<p>I have been making quite some use of Jensen&#8217;s inequality recently. It states that the expected value of a convex transformation of a random variable is at least the value of the convex function at the mean of the random variable. More formally, if ƒ is a real-valued convex function over some finite dimensional convex set <i>X</i> and <i>x</i> is an <i>X</i>-valued random variable then we can define the <em>Jensen gap</em></p>
<div class='maruku-equation'><img class='maruku-png' src='/images/latex/2fea699c1c6930c8ed2b536c620e7247.png' alt='$J_f(x) := \mathbb{E}\left[ f\left(x\right) \right] - f\left(\mathbb{E}\left[ x \right]\right)$' style='height: 2.44444444444444ex;' /><span class='maruku-eq-tex'><code style='display: none'>J_f(x) := \mathbb{E}\left[ f\left(x\right) \right] - f\left(\mathbb{E}\left[ x \right]\right)</code></span></div>
<p>where <span class='maruku-inline'><img class='maruku-png' src='/images/latex/24403ce9e741de8d598f80b6db576f91.png' alt='$\mathbb{E}$' style='vertical-align: -0.0ex;height: 1.55555555555556ex;' /></span> denotes expectation. Jensen&#8217;s inequality states that this gap is never negative, that is, <span class='maruku-inline'><img class='maruku-png' src='/images/latex/8f1129abdd8a732b7c329f09b82d2cd5.png' alt='$J_f(x) \geq 0$' style='vertical-align: -0.666666666666667ex;height: 2.44444444444444ex;' /></span> or equivalently,</p>
<div class='maruku-equation'><img class='maruku-png' src='/images/latex/adfe2d40933850daa32583e30d64b658.png' alt='$\mathbb{E}\left[ f\left(x\right) \right] \geq f\left(\mathbb{E}\left[ x \right]\right).$' style='height: 2.33333333333333ex;' /><span class='maruku-eq-tex'><code style='display: none'>\mathbb{E}\left[ f\left(x\right) \right] \geq f\left(\mathbb{E}\left[ x \right]\right).</code></span></div>
<p>This is a fairly simple but important inequality in the study of convex functions. Through judicious choice of the convex function it can be used to derive a <a href='http://en.wikipedia.org/wiki/Inequality_of_arithmetic_and_geometric_means#Proof_of_the_generalized_AM-GM_inequality_using_Jensen.27s_inequality'>general AM-GM inequality</a> and many results in information theory. I&#8217;ve been interested in it because DeGroot&#8217;s notion of <a href='http://projecteuclid.org/euclid.aoms/1177704567'>statistical information</a> and measures of the distance between probability distributions called <a href='http://en.wikipedia.org/wiki/F-divergence'>f-divergences</a> can both be expressed as a Jensen gap and consequently related to each other.</p>

<p>Jensen&#8217;s inequality is not difficult to prove. It is almost a direct consequence of the definition of convexity and the linearity of expectation. However, all of the proofs I&#8217;ve read, including those in books by <a href='http://books.google.com/books?id=wj4Fh4h_V7QC'>Rockafellar</a> and by <a href='http://books.google.com/books?id=Wv_zxEExK3QC'>Dudley</a> feel like they are from the <a href='http://en.wikipedia.org/wiki/Nicolas_Bourbaki'>Bourbaki</a> school in that they present the proof without recourse to any diagrams.</p>

<p>I was quite happy then to have found a graphical &#8220;proof&#8221; of Jensen&#8217;s inequality. By this I mean a proof in the style of the <a href='http://www.math.ntnu.no/~hanche/pythagoras/'>proof of Pythagoras&#8217; theorem</a> that is simply a diagram with the word &#8220;Behold!&#8221; above it.</p>
<dl class='figure'>
<dt>
	<img title='Jensen\&#039;s Inequality' src='/images/figures/jensen.png' alt='Jensen\&#039;s Inequality' />
</dt><dd>
	<strong>Figure 1.</strong> Behold! A graphical demonstration of Jensen&#039;s Inequality. The expectations shown are with respect to an arbitrary discrete distribution over the x<sub>i</sub>"
</dd>
</dl>
<p>Unfortunately, the diagram in Figure 1 is not quite as transparent as the Pythagorean proof so a little discussion is probably required. The diagram shows an instance of Jensen&#8217;s inequality for a discrete distribution where the random variable <span class='maruku-inline'><img class='maruku-png' src='/images/latex/d7c817bcd91b45d2e83059cbc1fbfb32.png' alt='$x$' style='vertical-align: -0.0ex;height: 1.0ex;' /></span> takes on one of the <i>n</i> values <span class='maruku-inline'><img class='maruku-png' src='/images/latex/1344034f927a925332cfa5487d44f7d5.png' alt='$x_i$' style='vertical-align: -0.333333333333333ex;height: 1.33333333333333ex;' /></span> with with probability <span class='maruku-inline'><img class='maruku-png' src='/images/latex/5a1ac2a0cfd3febf69f8b26c56f32a0a.png' alt='$p_i$' style='vertical-align: -0.444444444444444ex;height: 1.44444444444444ex;' /></span>.</p>

<p>Note that the points <span class='maruku-inline'><img class='maruku-png' src='/images/latex/dc02a2fcc4d8147660a351278660c0bc.png' alt='$(x_i, f(x_i))$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> form the vertices of a polygon which, by the convexity of ƒ, must also be convex and lie within the epigraph of ƒ (the blue shaded area above ƒ). Furthermore, since the <span class='maruku-inline'><img class='maruku-png' src='/images/latex/5a1ac2a0cfd3febf69f8b26c56f32a0a.png' alt='$p_i$' style='vertical-align: -0.444444444444444ex;height: 1.44444444444444ex;' /></span> are probabilities they satisfy <span class='maruku-inline'><img class='maruku-png' src='/images/latex/fb543a05199d05c769041bd298ddd937.png' alt='$\sum_i p_i = 1$' style='vertical-align: -0.444444444444444ex;height: 2.0ex;' /></span>. This means the expected value of the random variable <span class='maruku-inline'><img class='maruku-png' src='/images/latex/352e303d08d28a387f10ab0acd0e5804.png' alt='$(x, f(x))$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> given by</p>
<div class='maruku-equation'><img class='maruku-png' src='/images/latex/16710e8369a51e13b4cde1ba2342a15e.png' alt='$\displaystyle	   \mathbb{E}[(x, f(x))] = \sum_{i=1}^n p_i \left(x_i, f(x_i)\right)$' style='height: 6.0ex;' /><span class='maruku-eq-tex'><code style='display: none'>\displaystyle	   \mathbb{E}[(x, f(x))] = \sum_{i=1}^n p_i \left(x_i, f(x_i)\right)</code></span></div>
<p>is a convex combination and so must also lie within the dashed polygon. In fact, since <span class='maruku-inline'><img class='maruku-png' src='/images/latex/52091795c5e97a511331938a373fe0df.png' alt='$\mathbb{E}[(x, f(x))] = \left(\mathbb{E}[x], \mathbb{E}[f(x)]\right)$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> it must lie above <span class='maruku-inline'><img class='maruku-png' src='/images/latex/8ad2b3c9ba44f0d8df315329b100cb3b.png' alt='$f\left(\mathbb{E}[x]\right)$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> thus giving the result.</p>

<p>Although the diagram in Figure 1 assumes a 1-dimensional space <i>X</i> the above argument generalises to higher dimensions in an analogous manner. Also, the general result for non-discrete distributions can be gleamed from the provided diagram by a hand-wavy limiting argument. By adding more <span class='maruku-inline'><img class='maruku-png' src='/images/latex/1344034f927a925332cfa5487d44f7d5.png' alt='$x_i$' style='vertical-align: -0.333333333333333ex;height: 1.33333333333333ex;' /></span> to the diagram the dashed polygon the shaded area will approximate the graph of ƒ better. So, by the earlier argument for the discrete case, the expected value of <span class='maruku-inline'><img class='maruku-png' src='/images/latex/d7c817bcd91b45d2e83059cbc1fbfb32.png' alt='$x$' style='vertical-align: -0.0ex;height: 1.0ex;' /></span> will remain within the polygon and thus within the shaded area and thus above ƒ. Since this holds for an arbitrary number of points and nothing weird happens as we take the limit we have the continuous result.</p>

<p>A somewhat surprising fact about Jensen&#8217;s inequality is that its converse is also true. By this I mean that if ƒ is a function such that its Jensen gap <span class='maruku-inline'><img class='maruku-png' src='/images/latex/573ff1e59b5acbeb0d99c99b1617bf41.png' alt='$J_f(x)$' style='vertical-align: -0.666666666666667ex;height: 2.44444444444444ex;' /></span> is non-negative for all distributions of the random variable <i>x</i> then ƒ is necessarily convex. The contrapositive of this statement is: ƒ non-convex implies the existence of a random variable <i>x</i> so that <span class='maruku-inline'><img class='maruku-png' src='/images/latex/e5dac65a5ccfdddb3e6ed5e4155aac55.png' alt='$J_f(x) &lt; 0$' style='vertical-align: -0.666666666666667ex;height: 2.44444444444444ex;' /></span>.</p>

<p>Considering Figure 1 again gives some intuition as to why this must be the case. If ƒ was non-convex then its epigraph must, by definition, also be non-convex. This means I could choose some <span class='maruku-inline'><img class='maruku-png' src='/images/latex/1344034f927a925332cfa5487d44f7d5.png' alt='$x_i$' style='vertical-align: -0.333333333333333ex;height: 1.33333333333333ex;' /></span> so that one of the dashed lines lies outside the shaded area. This means I can then choose <span class='maruku-inline'><img class='maruku-png' src='/images/latex/5a1ac2a0cfd3febf69f8b26c56f32a0a.png' alt='$p_i$' style='vertical-align: -0.444444444444444ex;height: 1.44444444444444ex;' /></span> so that the mean <span class='maruku-inline'><img class='maruku-png' src='/images/latex/69fefceb8ee611419d9f36d52ee09593.png' alt='$\mathbb{E}[(x, f(x))]$' style='vertical-align: -0.555555555555556ex;height: 2.33333333333333ex;' /></span> lies outside the shaded area and thus below the graph of ƒ.</p>

<p>Of course, no self-respecting mathematician would call the above arguments a proof of Jensen&#8217;s inequality. There are too many edge cases and subtleties (especially in the continuous case) that I&#8217;ve ignored. That said, I believe the statement and thrust of the inequality can be quickly arrived at from the simple diagram above. When using tools like Jensen&#8217;s inequality, I find this type of quick insight more valuable than a long, careful technical statement and proof. The latter is valuable to but if I need this level of detail I would look it up rather than try to dredge it up from my sometimes unreliable memory.</p>

  <address class="signature">
    <a class="author" href="http://madhur.github.com">Madhur Ahuja</a> 
    <span class="date">17 November 2008</span>
    <span class="location">Canberra, Australia</span>
  </address>
</div><!-- End Page -->


<!-- Discus Comments -->
<div id="disqus_thread"></div>

<!-- Enable Disqus comments -->
<script type="text/javascript">
	var disqus_iframe_css = "http://mark.reid.name/css/screen.css";
	var disqus_title = "Behold! Jensen's Inequality";
	var disqus_message = "Unsatisfied with the very algebraic and formal proofs of Jensen's inequality, I present a diagram that gives a graphical intuition for the result.";
</script>
<script type="text/javascript" src="http://disqus.com/forums/markreid/embed.js"></script>

<noscript>
		<a href="http://markreid.disqus.com/?url=ref">View the discussion thread.</a>
</noscript>

  
  <div id="footer">
	<address>
		<span class="copyright">
			Content &amp; Design by 
			<a href="/info/site.html">Madhur Ahuja</a>
			<br/>
			(Some rights reserved)			
		</span>
		<span class="engine">
			Powered by 
			<a href="http://github.com/mreid/jekyll/" title="A static, minimalist CMS">Jekyll</a>
		</span>
	</address>
  </div>
</div>
<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->
</body>
</html>
